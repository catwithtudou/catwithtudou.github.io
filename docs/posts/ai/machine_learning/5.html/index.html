<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’ - </title><meta name="Description" content="ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸&#39;s blog"><meta property="og:title" content="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’" />
<meta property="og:description" content="åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å…ƒçº¿æ€§å›å½’åº”ç”¨ å›å½’Regression ä¸€å…ƒçº¿æ€§å›å½’ å›å½’åˆ†æ(regression analysis)ç”¨æ¥å»ºç«‹æ–¹ç¨‹æ¨¡æ‹Ÿä¸¤ä¸ªæˆ–è€…" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhengyua.cn/posts/ai/machine_learning/5.html/" /><meta property="og:image" content="https://zhengyua.cn/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-06T11:59:20+08:00" />
<meta property="article:modified_time" content="2020-03-06T11:59:20+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://zhengyua.cn/logo.png"/>

<meta name="twitter:title" content="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’"/>
<meta name="twitter:description" content="åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å…ƒçº¿æ€§å›å½’åº”ç”¨ å›å½’Regression ä¸€å…ƒçº¿æ€§å›å½’ å›å½’åˆ†æ(regression analysis)ç”¨æ¥å»ºç«‹æ–¹ç¨‹æ¨¡æ‹Ÿä¸¤ä¸ªæˆ–è€…"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" href="https://zhengyua.cn/posts/ai/machine_learning/5.html/" /><link rel="prev" href="https://zhengyua.cn/posts/ai/machine_learning/4.html/" /><link rel="next" href="https://zhengyua.cn/posts/0.html/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/zhengyua.cn\/posts\/ai\/machine_learning\/5.html\/"
        },"genre": "posts","keywords": "ai, machine_learning, note","wordcount":  4787 ,
        "url": "https:\/\/zhengyua.cn\/posts\/ai\/machine_learning\/5.html\/","datePublished": "2020-03-06T11:59:20+08:00","dateModified": "2020-03-06T11:59:20+08:00","publisher": {
            "@type": "Organization",
            "name": "ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸"},"author": {
                "@type": "Person",
                "name": "ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title=""><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> æ–‡ç«  </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title=""><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/posts/" title="">æ–‡ç« </a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/catwithtudou" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸</a></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/machine-learning/"><i class="far fa-folder fa-fw"></i>machine learning</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-03-06">2020-03-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 4787 å­—&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 10 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å…ƒçº¿æ€§å›å½’åº”ç”¨">åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å…ƒçº¿æ€§å›å½’åº”ç”¨</a>
          <ul>
            <li><a href="#å›å½’regression">å›å½’Regression</a>
              <ul>
                <li><a href="#ä¸€å…ƒçº¿æ€§å›å½’">ä¸€å…ƒçº¿æ€§å›å½’</a></li>
                <li><a href="#æ±‚è§£æ–¹ç¨‹ç³»æ•°">æ±‚è§£æ–¹ç¨‹ç³»æ•°</a></li>
              </ul>
            </li>
            <li><a href="#ä»£ä»·å‡½æ•°cost-function">ä»£ä»·å‡½æ•°Cost Function</a>
              <ul>
                <li><a href="#ç›¸å…³ç³»æ•°">ç›¸å…³ç³»æ•°</a></li>
                <li><a href="#å†³å®šç³»æ•°">å†³å®šç³»æ•°</a></li>
              </ul>
            </li>
            <li><a href="#æ¢¯åº¦ä¸‹é™æ³•gradient-descent">æ¢¯åº¦ä¸‹é™æ³•Gradient Descent</a>
              <ul>
                <li><a href="#ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æ±‚è§£çº¿æ€§å›å½’">ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æ±‚è§£çº¿æ€§å›å½’</a></li>
                <li><a href="#éå‡¸å‡½æ•°å’Œå‡¸å‡½æ•°">éå‡¸å‡½æ•°å’Œå‡¸å‡½æ•°</a></li>
                <li><a href="#ä¼˜åŒ–è¿‡ç¨‹">ä¼˜åŒ–è¿‡ç¨‹</a></li>
                <li><a href="#ä»£ç å®ç°">ä»£ç å®ç°</a>
                  <ul>
                    <li><a href="#è¿è¡Œç»“æœ">è¿è¡Œç»“æœ</a></li>
                  </ul>
                </li>
                <li><a href="#ä½¿ç”¨sklearnå®ç°-ä¸€å…ƒçº¿æ€§å›å½’">ä½¿ç”¨sklearnå®ç°-ä¸€å…ƒçº¿æ€§å›å½’</a>
                  <ul>
                    <li><a href="#è¿è¡Œç»“æœ-1">è¿è¡Œç»“æœ</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„å¤šå…ƒçº¿æ€§å›å½’åº”ç”¨">åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„å¤šå…ƒçº¿æ€§å›å½’åº”ç”¨</a>
          <ul>
            <li><a href="#å¤šå…ƒçº¿æ€§å›å½’">å¤šå…ƒçº¿æ€§å›å½’</a></li>
            <li><a href="#å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹">å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹</a></li>
            <li><a href="#æ¢¯åº¦ä¸‹é™æ³•-å¤šå…ƒçº¿æ€§å›å½’">æ¢¯åº¦ä¸‹é™æ³•-å¤šå…ƒçº¿æ€§å›å½’</a>
              <ul>
                <li><a href="#ä»£ç å®ç°-1">ä»£ç å®ç°</a>
                  <ul>
                    <li><a href="#è¿è¡Œç»“æœ-2">è¿è¡Œç»“æœ</a></li>
                  </ul>
                </li>
                <li><a href="#åŸºäºsklearnå®ç°å¤šå…ƒçº¿æ€§å›å½’">åŸºäºsklearnå®ç°å¤šå…ƒçº¿æ€§å›å½’</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#å¤šé¡¹å¼å›å½’åŠåº”ç”¨">å¤šé¡¹å¼å›å½’åŠåº”ç”¨</a>
          <ul>
            <li><a href="#ä»£ç å®ç°-2">ä»£ç å®ç°</a></li>
          </ul>
        </li>
        <li><a href="#æ ‡å‡†æ–¹ç¨‹æ³•normal-equation">æ ‡å‡†æ–¹ç¨‹æ³•(Normal Equation)</a>
          <ul>
            <li><a href="#çŸ©é˜µä¸å¯é€†çš„æƒ…å†µ">çŸ©é˜µä¸å¯é€†çš„æƒ…å†µ</a></li>
            <li><a href="#æ¢¯åº¦ä¸‹é™æ³•vsæ ‡å‡†æ–¹ç¨‹æ³•">æ¢¯åº¦ä¸‹é™æ³•vsæ ‡å‡†æ–¹ç¨‹æ³•</a></li>
            <li><a href="#ä»£ç å®ç°-3">ä»£ç å®ç°</a>
              <ul>
                <li><a href="#è¿è¡Œç»“æœ-3">è¿è¡Œç»“æœ</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#ç‰¹å¾ç¼©æ”¾äº¤å‰éªŒè¯æ³•">ç‰¹å¾ç¼©æ”¾äº¤å‰éªŒè¯æ³•</a>
          <ul>
            <li><a href="#ç‰¹å¾ç¼©æ”¾">ç‰¹å¾ç¼©æ”¾</a></li>
            <li><a href="#äº¤å‰éªŒè¯æ³•">äº¤å‰éªŒè¯æ³•</a></li>
          </ul>
        </li>
        <li><a href="#è¿‡æ‹Ÿåˆoverfittingæ­£åˆ™åŒ–regularized">è¿‡æ‹Ÿåˆ(Overfitting)&amp;æ­£åˆ™åŒ–(Regularized)</a>
          <ul>
            <li><a href="#è¿‡æ‹Ÿåˆ">è¿‡æ‹Ÿåˆ</a></li>
            <li><a href="#æ­£åˆ™åŒ–">æ­£åˆ™åŒ–</a></li>
          </ul>
        </li>
        <li><a href="#å²­å›å½’lassoå›å½’å¼¹æ€§ç½‘çš„åº”ç”¨">å²­å›å½’/LASSOå›å½’/å¼¹æ€§ç½‘çš„åº”ç”¨</a>
          <ul>
            <li><a href="#å²­å›å½’ridge-regression">å²­å›å½’(Ridge Regression)</a>
              <ul>
                <li><a href="#sklearn-ä»£ç å®ç°">sklearn-ä»£ç å®ç°</a>
                  <ul>
                    <li><a href="#è¿è¡Œç»“æœ-4">è¿è¡Œç»“æœ</a></li>
                  </ul>
                </li>
                <li><a href="#æ ‡å‡†æ–¹ç¨‹æ³•-ä»£ç å®ç°">æ ‡å‡†æ–¹ç¨‹æ³•-ä»£ç å®ç°</a></li>
              </ul>
            </li>
            <li><a href="#lasso">LASSO</a>
              <ul>
                <li><a href="#lassoä¸å²­å›å½’">LASSOä¸å²­å›å½’</a></li>
                <li><a href="#sklearn-ä»£ç å®ç°lasso">sklearn-ä»£ç å®ç°Lasso</a></li>
              </ul>
            </li>
            <li><a href="#å¼¹æ€§ç½‘elastic-net">å¼¹æ€§ç½‘(Elastic Net)</a>
              <ul>
                <li><a href="#sklearn-ä»£ç å®ç°elasticnet">sklearn-ä»£ç å®ç°ElasticNet</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å…ƒçº¿æ€§å›å½’åº”ç”¨">åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å…ƒçº¿æ€§å›å½’åº”ç”¨</h2>
<h3 id="å›å½’regression">å›å½’Regression</h3>
<h4 id="ä¸€å…ƒçº¿æ€§å›å½’">ä¸€å…ƒçº¿æ€§å›å½’</h4>
<ul>
<li>å›å½’åˆ†æ(regression analysis)ç”¨æ¥å»ºç«‹æ–¹ç¨‹æ¨¡æ‹Ÿä¸¤ä¸ªæˆ–è€…å¤šä¸ªå˜é‡ä¹‹é—´å¦‚ä½•å…³è”</li>
<li>è¢«é¢„æµ‹çš„å˜é‡å«åšï¼šå› å˜é‡(dependent variable), è¾“å‡º(output)</li>
<li>è¢«ç”¨æ¥è¿›è¡Œé¢„æµ‹çš„å˜é‡å«åšï¼š è‡ªå˜é‡(independent variable), è¾“å…¥(input)</li>
<li>ä¸€å…ƒçº¿æ€§å›å½’åŒ…å«ä¸€ä¸ªè‡ªå˜é‡å’Œä¸€ä¸ªå› å˜é‡</li>
<li>ä»¥ä¸Šä¸¤ä¸ªå˜é‡çš„å…³ç³»ç”¨ä¸€æ¡ç›´çº¿æ¥æ¨¡æ‹Ÿ</li>
<li>å¦‚æœåŒ…å«ä¸¤ä¸ªä»¥ä¸Šçš„è‡ªå˜é‡ï¼Œåˆ™ç§°ä½œå¤šå…ƒå›å½’åˆ†æ(multiple regression)</li>
</ul>
<p>â„ğœƒ ğ‘¥ = ğœƒ0 + ğœƒ1ğ‘¥</p>
<p>è¿™ä¸ªæ–¹ç¨‹å¯¹åº”çš„å›¾åƒæ˜¯ä¸€æ¡ç›´çº¿ï¼Œç§°ä½œå›å½’çº¿ã€‚å…¶ä¸­ï¼Œğœƒ1ä¸ºå›å½’çº¿çš„æ–œç‡ï¼Œ ğœƒ0ä¸ºå›å½’çº¿çš„æˆªè·ã€‚</p>
<ul>
<li>çº¿æ€§å›å½’çš„ä¸‰ç§å…³ç³»:
<ol>
<li>æ­£ç›¸å…³</li>
<li>è´Ÿç›¸å…³</li>
<li>ä¸ç›¸å…³</li>
</ol>
</li>
</ul>
<h4 id="æ±‚è§£æ–¹ç¨‹ç³»æ•°">æ±‚è§£æ–¹ç¨‹ç³»æ•°</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111133.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111133.png, https://img.zhengyua.cn/img/20200303111133.png 1.5x, https://img.zhengyua.cn/img/20200303111133.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111133.png"
        title="https://img.zhengyua.cn/img/20200303111133.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111247.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111247.png, https://img.zhengyua.cn/img/20200303111247.png 1.5x, https://img.zhengyua.cn/img/20200303111247.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111247.png"
        title="https://img.zhengyua.cn/img/20200303111247.png" /></p>
<h3 id="ä»£ä»·å‡½æ•°cost-function">ä»£ä»·å‡½æ•°Cost Function</h3>
<ul>
<li>
<p>æœ€å°äºŒä¹˜æ³•</p>
</li>
<li>
<p>çœŸå®å€¼yï¼Œé¢„æµ‹å€¼â„ğœƒ ğ‘¥ ï¼Œåˆ™è¯¯å·®å¹³æ–¹ä¸º(y âˆ’ â„_ğœƒ(x))^2</p>
</li>
<li>
<p>æ‰¾åˆ°åˆé€‚çš„å‚æ•°ï¼Œä½¿å¾—è¯¯å·®å¹³æ–¹å’Œï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111453.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111453.png, https://img.zhengyua.cn/img/20200303111453.png 1.5x, https://img.zhengyua.cn/img/20200303111453.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111453.png"
        title="https://img.zhengyua.cn/img/20200303111453.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111529.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111529.png, https://img.zhengyua.cn/img/20200303111529.png 1.5x, https://img.zhengyua.cn/img/20200303111529.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111529.png"
        title="https://img.zhengyua.cn/img/20200303111529.png" /></p>
<ul>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111542.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111542.png, https://img.zhengyua.cn/img/20200303111542.png 1.5x, https://img.zhengyua.cn/img/20200303111542.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111542.png"
        title="https://img.zhengyua.cn/img/20200303111542.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111631.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111631.png, https://img.zhengyua.cn/img/20200303111631.png 1.5x, https://img.zhengyua.cn/img/20200303111631.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111631.png"
        title="https://img.zhengyua.cn/img/20200303111631.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111704.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111704.png, https://img.zhengyua.cn/img/20200303111704.png 1.5x, https://img.zhengyua.cn/img/20200303111704.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111704.png"
        title="https://img.zhengyua.cn/img/20200303111704.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111753.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111753.png, https://img.zhengyua.cn/img/20200303111753.png 1.5x, https://img.zhengyua.cn/img/20200303111753.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111753.png"
        title="https://img.zhengyua.cn/img/20200303111753.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111812.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111812.png, https://img.zhengyua.cn/img/20200303111812.png 1.5x, https://img.zhengyua.cn/img/20200303111812.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111812.png"
        title="https://img.zhengyua.cn/img/20200303111812.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111828.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111828.png, https://img.zhengyua.cn/img/20200303111828.png 1.5x, https://img.zhengyua.cn/img/20200303111828.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111828.png"
        title="https://img.zhengyua.cn/img/20200303111828.png" /></p>
</li>
</ul>
</li>
</ul>
<h4 id="ç›¸å…³ç³»æ•°">ç›¸å…³ç³»æ•°</h4>
<p>ä½¿ç”¨ç›¸å…³ç³»æ•°å»è¡¡é‡çº¿æ€§ç›¸å…³æ€§çš„å¼ºå¼±</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303111914.png"
        data-srcset="https://img.zhengyua.cn/img/20200303111914.png, https://img.zhengyua.cn/img/20200303111914.png 1.5x, https://img.zhengyua.cn/img/20200303111914.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303111914.png"
        title="https://img.zhengyua.cn/img/20200303111914.png" /></p>
<h4 id="å†³å®šç³»æ•°">å†³å®šç³»æ•°</h4>
<p>ç›¸å…³ç³»æ•°ğ‘…2(coefficient of determination)æ˜¯ç”¨æ¥æè¿°ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»çš„ï¼Œä½†å†³å®šç³»æ•°çš„é€‚ç”¨èŒƒå›´æ›´å¹¿ï¼Œå¯ä»¥ç”¨äºæè¿°éçº¿æ€§æˆ–è€…æœ‰ä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šè‡ªå˜é‡çš„ç›¸å…³å…³ç³»ã€‚å®ƒå¯ä»¥ç”¨æ¥è¯„ä»·æ¨¡å‹çš„æ•ˆæœ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112016.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112016.png, https://img.zhengyua.cn/img/20200303112016.png 1.5x, https://img.zhengyua.cn/img/20200303112016.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112016.png"
        title="https://img.zhengyua.cn/img/20200303112016.png" /></p>
<h3 id="æ¢¯åº¦ä¸‹é™æ³•gradient-descent">æ¢¯åº¦ä¸‹é™æ³•Gradient Descent</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112058.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112058.png, https://img.zhengyua.cn/img/20200303112058.png 1.5x, https://img.zhengyua.cn/img/20200303112058.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112058.png"
        title="https://img.zhengyua.cn/img/20200303112058.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112113.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112113.png, https://img.zhengyua.cn/img/20200303112113.png 1.5x, https://img.zhengyua.cn/img/20200303112113.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112113.png"
        title="https://img.zhengyua.cn/img/20200303112113.png" /></p>
<ul>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112150.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112150.png, https://img.zhengyua.cn/img/20200303112150.png 1.5x, https://img.zhengyua.cn/img/20200303112150.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112150.png"
        title="https://img.zhengyua.cn/img/20200303112150.png" /></p>
<blockquote>
<p>å­¦ä¹ ç‡ä¸èƒ½å¤ªå°ï¼Œä¹Ÿä¸èƒ½å¤ªå¤§ï¼Œå¯ä»¥å¤šå°è¯•ä¸€äº›å€¼0.1,0.03,0.01,0.003,0.001,0.0003,0.0001â€¦,å¦åˆ™æœ‰å¯èƒ½ä¼šé™·å…¥å±€éƒ¨æå°å€¼</p>
</blockquote>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112307.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112307.png, https://img.zhengyua.cn/img/20200303112307.png 1.5x, https://img.zhengyua.cn/img/20200303112307.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112307.png"
        title="https://img.zhengyua.cn/img/20200303112307.png" /></li>
</ul>
</li>
</ul>
<h4 id="ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æ±‚è§£çº¿æ€§å›å½’">ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æ±‚è§£çº¿æ€§å›å½’</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112406.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112406.png, https://img.zhengyua.cn/img/20200303112406.png 1.5x, https://img.zhengyua.cn/img/20200303112406.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112406.png"
        title="https://img.zhengyua.cn/img/20200303112406.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112547.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112547.png, https://img.zhengyua.cn/img/20200303112547.png 1.5x, https://img.zhengyua.cn/img/20200303112547.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112547.png"
        title="https://img.zhengyua.cn/img/20200303112547.png" /></p>
<h4 id="éå‡¸å‡½æ•°å’Œå‡¸å‡½æ•°">éå‡¸å‡½æ•°å’Œå‡¸å‡½æ•°</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112654.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112654.png, https://img.zhengyua.cn/img/20200303112654.png 1.5x, https://img.zhengyua.cn/img/20200303112654.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112654.png"
        title="https://img.zhengyua.cn/img/20200303112654.png" /></p>
<ul>
<li>
<p>çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°æ˜¯å‡¸å‡½æ•°</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112617.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112617.png, https://img.zhengyua.cn/img/20200303112617.png 1.5x, https://img.zhengyua.cn/img/20200303112617.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112617.png"
        title="https://img.zhengyua.cn/img/20200303112617.png" /></p>
</li>
</ul>
<h4 id="ä¼˜åŒ–è¿‡ç¨‹">ä¼˜åŒ–è¿‡ç¨‹</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303112729.png"
        data-srcset="https://img.zhengyua.cn/img/20200303112729.png, https://img.zhengyua.cn/img/20200303112729.png 1.5x, https://img.zhengyua.cn/img/20200303112729.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303112729.png"
        title="https://img.zhengyua.cn/img/20200303112729.png" /></p>
<h4 id="ä»£ç å®ç°">ä»£ç å®ç°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&#34;data.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&#34;,&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#learning rate</span>
</span></span><span class="line"><span class="cl"><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.0001</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æˆªè·</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æ–œç‡</span>
</span></span><span class="line"><span class="cl"><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æœ€å¤§è¿­ä»£æ¬¡æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">epochs</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æœ€å°äºŒä¹˜æ³•</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compute_error</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">totalError</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#(çœŸå®å€¼-é¢„æµ‹å€¼)^2</span>
</span></span><span class="line"><span class="cl">        <span class="n">totalError</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">totalError</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gradient_descent_runner</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#è®¡ç®—æ€»æ•°æ®é‡</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">b_grad</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">k_grad</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">b_grad</span> <span class="o">+=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">((</span><span class="n">k</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">k_grad</span> <span class="o">+=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">((</span><span class="n">k</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">b_grad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">k_grad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#æ¯è¿­ä»£äº”æ¬¡,è¾“å‡ºå›¾åƒ</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;epochs :&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">x_data</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">k</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Starting b = </span><span class="si">{0}</span><span class="s2">, k = </span><span class="si">{1}</span><span class="s2">, error = </span><span class="si">{2}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Running ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">gradient_descent_runner</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">epochs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;After </span><span class="si">{0}</span><span class="s2"> iterations b = </span><span class="si">{1}</span><span class="s2">, k = </span><span class="si">{2}</span><span class="s2">, error = </span><span class="si">{3}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”»å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">x_data</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="è¿è¡Œç»“æœ">è¿è¡Œç»“æœ</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303180056.png"
        data-srcset="https://img.zhengyua.cn/img/20200303180056.png, https://img.zhengyua.cn/img/20200303180056.png 1.5x, https://img.zhengyua.cn/img/20200303180056.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303180056.png"
        title="https://img.zhengyua.cn/img/20200303180056.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303180118.png"
        data-srcset="https://img.zhengyua.cn/img/20200303180118.png, https://img.zhengyua.cn/img/20200303180118.png 1.5x, https://img.zhengyua.cn/img/20200303180118.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303180118.png"
        title="https://img.zhengyua.cn/img/20200303180118.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303180147.png"
        data-srcset="https://img.zhengyua.cn/img/20200303180147.png, https://img.zhengyua.cn/img/20200303180147.png 1.5x, https://img.zhengyua.cn/img/20200303180147.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303180147.png"
        title="https://img.zhengyua.cn/img/20200303180147.png" /></p>
<h4 id="ä½¿ç”¨sklearnå®ç°-ä¸€å…ƒçº¿æ€§å›å½’">ä½¿ç”¨sklearnå®ç°-ä¸€å…ƒçº¿æ€§å›å½’</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.</span> <span class="n">linear_model</span> <span class="kn">import</span> <span class="nn">LinearRegression</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&#34;data.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&#34;,&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åŠ ä¸Šçº¬åº¦</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">y_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="è¿è¡Œç»“æœ-1">è¿è¡Œç»“æœ</h5>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303192540.png"
        data-srcset="https://img.zhengyua.cn/img/20200303192540.png, https://img.zhengyua.cn/img/20200303192540.png 1.5x, https://img.zhengyua.cn/img/20200303192540.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303192540.png"
        title="https://img.zhengyua.cn/img/20200303192540.png" /></li>
</ul>
<h2 id="åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„å¤šå…ƒçº¿æ€§å›å½’åº”ç”¨">åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„å¤šå…ƒçº¿æ€§å›å½’åº”ç”¨</h2>
<h3 id="å¤šå…ƒçº¿æ€§å›å½’">å¤šå…ƒçº¿æ€§å›å½’</h3>
<ul>
<li>
<p>å•ç‰¹å¾</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303192828.png"
        data-srcset="https://img.zhengyua.cn/img/20200303192828.png, https://img.zhengyua.cn/img/20200303192828.png 1.5x, https://img.zhengyua.cn/img/20200303192828.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303192828.png"
        title="https://img.zhengyua.cn/img/20200303192828.png" /></p>
</li>
<li>
<p>å¤šç‰¹å¾</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303192849.png"
        data-srcset="https://img.zhengyua.cn/img/20200303192849.png, https://img.zhengyua.cn/img/20200303192849.png 1.5x, https://img.zhengyua.cn/img/20200303192849.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303192849.png"
        title="https://img.zhengyua.cn/img/20200303192849.png" /></p>
</li>
</ul>
<h3 id="å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹">å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹</h3>
<p>å½“Yå€¼çš„å½±å“å› ç´ ä¸æ˜¯å”¯ä¸€æ—¶ï¼Œé‡‡ç”¨å¤šå…ƒçº¿æ€§å›å½’</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303192924.png"
        data-srcset="https://img.zhengyua.cn/img/20200303192924.png, https://img.zhengyua.cn/img/20200303192924.png 1.5x, https://img.zhengyua.cn/img/20200303192924.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303192924.png"
        title="https://img.zhengyua.cn/img/20200303192924.png" /></p>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303192941.png"
        data-srcset="https://img.zhengyua.cn/img/20200303192941.png, https://img.zhengyua.cn/img/20200303192941.png 1.5x, https://img.zhengyua.cn/img/20200303192941.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303192941.png"
        title="https://img.zhengyua.cn/img/20200303192941.png" />
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303193004.png"
        data-srcset="https://img.zhengyua.cn/img/20200303193004.png, https://img.zhengyua.cn/img/20200303193004.png 1.5x, https://img.zhengyua.cn/img/20200303193004.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303193004.png"
        title="https://img.zhengyua.cn/img/20200303193004.png" /></li>
</ul>
</li>
</ul>
<h3 id="æ¢¯åº¦ä¸‹é™æ³•-å¤šå…ƒçº¿æ€§å›å½’">æ¢¯åº¦ä¸‹é™æ³•-å¤šå…ƒçº¿æ€§å›å½’</h3>
<h4 id="ä»£ç å®ç°-1">ä»£ç å®ç°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Delivery.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[[100.    4.    9.3]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 50.    3.    4.8]
</span></span></span><span class="line"><span class="cl"><span class="s1">[100.    4.    8.9]
</span></span></span><span class="line"><span class="cl"><span class="s1">[100.    2.    6.5]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 50.    2.    4.2]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 80.    2.    6.2]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 75.    3.    7.4]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 65.    4.    6. ]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 90.    3.    7.6]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 90.    2.    6.1]]
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ‡åˆ†æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[[100.   4.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 50.   3.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[100.   4.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[100.   2.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 50.   2.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 80.   2.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 75.   3.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 65.   4.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 90.   3.]
</span></span></span><span class="line"><span class="cl"><span class="s1">[ 90.   2.]]
</span></span></span><span class="line"><span class="cl"><span class="s1">[9.3 4.8 8.9 6.5 4.2 6.2 7.4 6.  7.6 6.1]
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å­¦ä¹ ç‡</span>
</span></span><span class="line"><span class="cl"><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.0001</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">theta0</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">theta1</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">theta2</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æœ€å¤§è¿­ä»£æ¬¡æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">epochs</span> <span class="o">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æœ€å°äºŒä¹˜æ³•</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compute_error</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">totalError</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">      <span class="n">totalError</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">theta1</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="n">theta0</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">totalError</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gradient_descent_runner</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#è®¡ç®—æ€»æ•°æ®é‡</span>
</span></span><span class="line"><span class="cl">  <span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="n">theta0_grad</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">      <span class="n">theta1_grad</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">      <span class="n">theta2_grad</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#è®¡ç®—æ¢¯åº¦çš„æ€»å’Œå†æ±‚å¹³å‡</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">          <span class="n">theta0_grad</span> <span class="o">+=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">theta1</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">          <span class="n">theta1_grad</span> <span class="o">+=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">theta1</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">          <span class="n">theta2_grad</span> <span class="o">+=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">theta1</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta0</span><span class="p">))</span> 
</span></span><span class="line"><span class="cl">      <span class="c1">#æ›´æ–°</span>
</span></span><span class="line"><span class="cl">      <span class="n">theta0</span> <span class="o">=</span> <span class="n">theta0</span> <span class="o">-</span> <span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">theta0_grad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">theta1</span> <span class="o">=</span> <span class="n">theta1</span> <span class="o">-</span> <span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">theta1_grad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">theta2</span> <span class="o">=</span> <span class="n">theta2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">theta2_grad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Starting theta0 = </span><span class="si">{0}</span><span class="s2">, theta1 = </span><span class="si">{1}</span><span class="s2">, theta2 = </span><span class="si">{2}</span><span class="s2">, error = </span><span class="si">{3}</span><span class="s2">&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">   <span class="nb">format</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Running....&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span> <span class="o">=</span> <span class="n">gradient_descent_runner</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">epochs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;After </span><span class="si">{0}</span><span class="s2"> iterations theta0 = </span><span class="si">{1}</span><span class="s2">, theta1 = </span><span class="si">{2}</span><span class="s2">, theta2 = </span><span class="si">{3}</span><span class="s2">, error = </span><span class="si">{4}</span><span class="s2">&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">   <span class="nb">format</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Starting theta0 = 0, theta1 = 0, theta2 = 0, error = 47.279999999999994
</span></span></span><span class="line"><span class="cl"><span class="s1">Running....
</span></span></span><span class="line"><span class="cl"><span class="s1">After 1000 iterations theta0 = 0.006971416196678632, theta1 = 0.08021042690771771, theta2 = 0.07611036240566814, error = 0.7731271432218118
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="n">x_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="n">x_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="n">theta0</span> <span class="o">+</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">theta1</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">theta2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»3Då›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åæ ‡è½´</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;Miles&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Num of Deleveries&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="è¿è¡Œç»“æœ-2">è¿è¡Œç»“æœ</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200303200436.png"
        data-srcset="https://img.zhengyua.cn/img/20200303200436.png, https://img.zhengyua.cn/img/20200303200436.png 1.5x, https://img.zhengyua.cn/img/20200303200436.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200303200436.png"
        title="https://img.zhengyua.cn/img/20200303200436.png" /></p>
<h4 id="åŸºäºsklearnå®ç°å¤šå…ƒçº¿æ€§å›å½’">åŸºäºsklearnå®ç°å¤šå…ƒçº¿æ€§å›å½’</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span> 
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Delivery.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ‡åˆ†æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºæ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;coefficients:&#34;</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æˆªè·</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;intercept:&#34;</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="n">x_test</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">102</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;predict:&#34;</span><span class="p">,</span><span class="n">predict</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="n">x_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="n">x_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">+</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»3Då›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åæ ‡è½´</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;Miles&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Num of Deleveries&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿è¡Œç»“æœä¸ä¸Šé¢ç±»ä¼¼,å°±ä¸å±•ç¤ºå‡ºæ¥äº†</li>
</ul>
<h2 id="å¤šé¡¹å¼å›å½’åŠåº”ç”¨">å¤šé¡¹å¼å›å½’åŠåº”ç”¨</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305080528.png"
        data-srcset="https://img.zhengyua.cn/img/20200305080528.png, https://img.zhengyua.cn/img/20200305080528.png 1.5x, https://img.zhengyua.cn/img/20200305080528.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305080528.png"
        title="https://img.zhengyua.cn/img/20200305080528.png" /></p>
<h3 id="ä»£ç å®ç°-2">ä»£ç å®ç°</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.lineaBr_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&#34;job.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&#34;,&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">x_data</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™é‡Œæ˜¯å¤šå…ƒçº¿æ€§å›å½’</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305082513.png"
        data-srcset="https://img.zhengyua.cn/img/20200305082513.png, https://img.zhengyua.cn/img/20200305082513.png 1.5x, https://img.zhengyua.cn/img/20200305082513.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305082513.png"
        title="https://img.zhengyua.cn/img/20200305082513.png" /></p>
<ul>
<li>å¯ä»¥çœ‹å‡ºä½¿ç”¨å¤šå…ƒçº¿æ€§å›å½’,æ•ˆæœå¹¶ä¸æ˜¯å¤ªå¥½,æ‰€ä»¥æˆ‘ä»¬æ¢æˆå¤šé¡¹å¼å›å½’æ¥å¯¹æ•°æ®è¿›è¡Œç‰¹å¾å¤„ç†ä¸€ä¸‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#å®šä¹‰å¤šé¡¹å¼å›å½’,degree(åç½®å€¼)çš„å€¼å¯ä»¥è°ƒèŠ‚å¤šé¡¹å¼çš„ç‰¹å¾</span>
</span></span><span class="line"><span class="cl"><span class="n">poly_reg</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç‰¹å¾å¤„ç†</span>
</span></span><span class="line"><span class="cl"><span class="n">x_poly</span> <span class="o">=</span> <span class="n">poly_reg</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x_poly</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å®šä¹‰å›å½’æ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®­ç»ƒæ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">lin_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_poly</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">poly_reg</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_data</span><span class="p">)),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;Truth of Bluff (Polynomial Regression)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&#34;Position level&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Salary&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305082613.png"
        data-srcset="https://img.zhengyua.cn/img/20200305082613.png, https://img.zhengyua.cn/img/20200305082613.png 1.5x, https://img.zhengyua.cn/img/20200305082613.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305082613.png"
        title="https://img.zhengyua.cn/img/20200305082613.png" /></p>
<ul>
<li>è¿™é‡Œçœ‹åˆ°é€šè¿‡è¿›è¡Œå¤šé¡¹å¼ç‰¹å¾å¤„ç†å,æ‹Ÿåˆç»“æœå°±æ¯”è¾ƒå¥½</li>
</ul>
<h2 id="æ ‡å‡†æ–¹ç¨‹æ³•normal-equation">æ ‡å‡†æ–¹ç¨‹æ³•(Normal Equation)</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305082720.png"
        data-srcset="https://img.zhengyua.cn/img/20200305082720.png, https://img.zhengyua.cn/img/20200305082720.png 1.5x, https://img.zhengyua.cn/img/20200305082720.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305082720.png"
        title="https://img.zhengyua.cn/img/20200305082720.png" /></p>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305082928.png"
        data-srcset="https://img.zhengyua.cn/img/20200305082928.png, https://img.zhengyua.cn/img/20200305082928.png 1.5x, https://img.zhengyua.cn/img/20200305082928.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305082928.png"
        title="https://img.zhengyua.cn/img/20200305082928.png" /></li>
</ul>
<p><strong>åˆ†å­å¸ƒå±€(Numerator-layout)</strong>: åˆ†å­ä¸ºåˆ—å‘é‡æˆ–è€…åˆ†æ¯ä¸ºè¡Œå‘é‡</p>
<p><strong>åˆ†æ¯å¸ƒå±€(Denominator-layout)</strong>:åˆ†å­ä¸ºè¡Œå‘é‡æˆ–è€…åˆ†æ¯ä¸ºåˆ—å‘é‡</p>
<blockquote>
<p><strong>æ±‚å¯¼å…¬å¼</strong>:https://en.wikipedia.org/wiki/Matrix_calculus#Scalar-by-vector_identiti</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305083105.png"
        data-srcset="https://img.zhengyua.cn/img/20200305083105.png, https://img.zhengyua.cn/img/20200305083105.png 1.5x, https://img.zhengyua.cn/img/20200305083105.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305083105.png"
        title="https://img.zhengyua.cn/img/20200305083105.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305083122.png"
        data-srcset="https://img.zhengyua.cn/img/20200305083122.png, https://img.zhengyua.cn/img/20200305083122.png 1.5x, https://img.zhengyua.cn/img/20200305083122.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305083122.png"
        title="https://img.zhengyua.cn/img/20200305083122.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305083241.png"
        data-srcset="https://img.zhengyua.cn/img/20200305083241.png, https://img.zhengyua.cn/img/20200305083241.png 1.5x, https://img.zhengyua.cn/img/20200305083241.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305083241.png"
        title="https://img.zhengyua.cn/img/20200305083241.png" /></p>
<h3 id="çŸ©é˜µä¸å¯é€†çš„æƒ…å†µ">çŸ©é˜µä¸å¯é€†çš„æƒ…å†µ</h3>
<ul>
<li>çº¿æ€§ç›¸å…³çš„ç‰¹å¾(å¤šé‡å…±çº¿æ€§)</li>
<li>ç‰¹å¾æ•°æ®å¤ªå¤š(æ ·æœ¬æ•°m&lt;=ç‰¹å¾æ•°é‡n)</li>
</ul>
<h3 id="æ¢¯åº¦ä¸‹é™æ³•vsæ ‡å‡†æ–¹ç¨‹æ³•">æ¢¯åº¦ä¸‹é™æ³•vsæ ‡å‡†æ–¹ç¨‹æ³•</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305083451.png"
        data-srcset="https://img.zhengyua.cn/img/20200305083451.png, https://img.zhengyua.cn/img/20200305083451.png 1.5x, https://img.zhengyua.cn/img/20200305083451.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305083451.png"
        title="https://img.zhengyua.cn/img/20200305083451.png" /></p>
<h3 id="ä»£ç å®ç°-3">ä»£ç å®ç°</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ ‡å‡†æ–¹ç¨‹æ³•æ±‚è§£å›å½’å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="n">xArr</span><span class="p">,</span> <span class="n">yArr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">xMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">xArr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">yMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">yArr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">xTx</span> <span class="o">=</span> <span class="n">xMat</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">xMat</span> <span class="c1">#çŸ©é˜µä¹˜æ³•</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#è®¡ç®—çŸ©é˜µçš„å€¼,å¦‚æœå€¼ä¸º0,è¯´æ˜è¯¥çŸ©é˜µæ²¡æœ‰é€†çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">xTx</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;This matrix cannot do inverse&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#xTx.T ä¸º xTx çš„é€†çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl">    <span class="n">ws</span> <span class="o">=</span> <span class="n">xTx</span><span class="o">.</span><span class="n">I</span> <span class="o">*</span> <span class="n">xMat</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">yMat</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ws</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&#34;data.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&#34;,&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»™æ ·æœ¬æ·»åŠ åç½®é¡¹</span>
</span></span><span class="line"><span class="cl"><span class="n">X_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">x_data</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">X_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ws</span> <span class="o">=</span> <span class="n">weights</span><span class="p">(</span><span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="mf">7.99102098</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">1.32243102</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">20</span><span class="p">],[</span><span class="mi">80</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">y_test</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_test</span><span class="o">*</span><span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data_predict</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_data</span><span class="o">*</span><span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data_predict</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è¿è¡Œç»“æœ-3">è¿è¡Œç»“æœ</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305085459.png"
        data-srcset="https://img.zhengyua.cn/img/20200305085459.png, https://img.zhengyua.cn/img/20200305085459.png 1.5x, https://img.zhengyua.cn/img/20200305085459.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305085459.png"
        title="https://img.zhengyua.cn/img/20200305085459.png" /></p>
<h2 id="ç‰¹å¾ç¼©æ”¾äº¤å‰éªŒè¯æ³•">ç‰¹å¾ç¼©æ”¾äº¤å‰éªŒè¯æ³•</h2>
<h3 id="ç‰¹å¾ç¼©æ”¾">ç‰¹å¾ç¼©æ”¾</h3>
<p><strong>æ•°æ®å½’ä¸€åŒ–:</strong></p>
<p>æ•°æ®å½’ä¸€åŒ–å°±æ˜¯æŠŠæ•°æ®çš„å–å€¼èŒƒå›´å¤„ç†ä¸º0-1æˆ–è€…-1-1ä¹‹é—´ã€‚</p>
<ul>
<li>
<p>ä»»æ„æ•°æ®è½¬åŒ–ä¸º0-1ä¹‹é—´ï¼šnewValue = (oldValue-min)/(max-min)</p>
<p>ä»»æ„æ•°æ®è½¬åŒ–ä¸º-1-1ä¹‹é—´ï¼šnewValue = ((oldValue-min)/(max-min)-0.5)*2</p>
</li>
</ul>
<p><strong>å‡å€¼æ ‡å‡†åŒ–:</strong></p>
<p>xä¸ºç‰¹å¾æ•°æ®ï¼Œuä¸ºæ•°æ®çš„å¹³å‡å€¼ï¼Œsä¸ºæ•°æ®çš„æ–¹å·®</p>
<p>newValue = (oldValue-u)/s</p>
<h3 id="äº¤å‰éªŒè¯æ³•">äº¤å‰éªŒè¯æ³•</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305085823.png"
        data-srcset="https://img.zhengyua.cn/img/20200305085823.png, https://img.zhengyua.cn/img/20200305085823.png 1.5x, https://img.zhengyua.cn/img/20200305085823.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305085823.png"
        title="https://img.zhengyua.cn/img/20200305085823.png" /></p>
<ul>
<li>é€šè¿‡åˆ‡åˆ†æ•°æ®,æ¯ä¸ªéƒ¨åˆ†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†,ä¸”å°†æ¯ä¸ªéƒ¨åˆ†çš„è¯¯å·®åŠ èµ·æ¥è®¡ç®—å¹³å‡å€¼å³ä¸ºæœ€ç»ˆè¯¯å·®</li>
</ul>
<h2 id="è¿‡æ‹Ÿåˆoverfittingæ­£åˆ™åŒ–regularized">è¿‡æ‹Ÿåˆ(Overfitting)&amp;æ­£åˆ™åŒ–(Regularized)</h2>
<h3 id="è¿‡æ‹Ÿåˆ">è¿‡æ‹Ÿåˆ</h3>
<p><strong>æ‹Ÿåˆæƒ…å†µ:</strong></p>
<ul>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305090820.png"
        data-srcset="https://img.zhengyua.cn/img/20200305090820.png, https://img.zhengyua.cn/img/20200305090820.png 1.5x, https://img.zhengyua.cn/img/20200305090820.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305090820.png"
        title="https://img.zhengyua.cn/img/20200305090820.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305090846.png"
        data-srcset="https://img.zhengyua.cn/img/20200305090846.png, https://img.zhengyua.cn/img/20200305090846.png 1.5x, https://img.zhengyua.cn/img/20200305090846.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305090846.png"
        title="https://img.zhengyua.cn/img/20200305090846.png" /></p>
</li>
</ul>
<p><strong>é˜²æ­¢è¿‡æ‹Ÿåˆ:</strong></p>
<ul>
<li>å‡å°‘ç‰¹å¾</li>
<li>å¢åŠ æ•°æ®é‡</li>
<li>æ­£åˆ™åŒ–</li>
</ul>
<h3 id="æ­£åˆ™åŒ–">æ­£åˆ™åŒ–</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305091000.png"
        data-srcset="https://img.zhengyua.cn/img/20200305091000.png, https://img.zhengyua.cn/img/20200305091000.png 1.5x, https://img.zhengyua.cn/img/20200305091000.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305091000.png"
        title="https://img.zhengyua.cn/img/20200305091000.png" /></p>
<h2 id="å²­å›å½’lassoå›å½’å¼¹æ€§ç½‘çš„åº”ç”¨">å²­å›å½’/LASSOå›å½’/å¼¹æ€§ç½‘çš„åº”ç”¨</h2>
<h3 id="å²­å›å½’ridge-regression">å²­å›å½’(Ridge Regression)</h3>
<blockquote>
<p>w = (ğ‘‹^ğ‘‡ğ‘‹)^(âˆ’1)ğ‘‹^ğ‘‡y</p>
<ul>
<li>å¦‚æœæ•°æ®çš„ç‰¹å¾æ¯”æ ·æœ¬ç‚¹è¿˜å¤šï¼Œæ•°æ®ç‰¹å¾nï¼Œæ ·æœ¬ä¸ªæ•°mï¼Œå¦‚æœn&gt;mï¼Œåˆ™è®¡ç®—æ—¶ä¼šå‡ºé”™ã€‚å› ä¸º(ğ‘‹^ğ‘‡ğ‘‹)ä¸æ˜¯æ»¡ç§©çŸ©é˜µï¼Œæ‰€ä»¥ä¸å¯é€†ã€‚</li>
</ul>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç»Ÿè®¡å­¦å®¶å¼•å…¥äº†å²­å›å½’çš„æ¦‚å¿µã€‚</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305091404.png"
        data-srcset="https://img.zhengyua.cn/img/20200305091404.png, https://img.zhengyua.cn/img/20200305091404.png 1.5x, https://img.zhengyua.cn/img/20200305091404.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305091404.png"
        title="https://img.zhengyua.cn/img/20200305091404.png" /></p>
<ul>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305091429.png"
        data-srcset="https://img.zhengyua.cn/img/20200305091429.png, https://img.zhengyua.cn/img/20200305091429.png 1.5x, https://img.zhengyua.cn/img/20200305091429.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305091429.png"
        title="https://img.zhengyua.cn/img/20200305091429.png" /></p>
</li>
<li>
<p>å²­å›å½’æœ€æ—©æ˜¯ç”¨æ¥å¤„ç†ç‰¹å¾æ•°å¤šäºæ ·æœ¬çš„æƒ…å†µï¼Œç°åœ¨ä¹Ÿç”¨äºåœ¨ä¼°è®¡ä¸­åŠ å…¥åå·®ï¼Œä»è€Œå¾—åˆ°æ›´å¥½çš„ä¼°è®¡ã€‚åŒæ—¶ä¹Ÿå¯ä»¥è§£å†³å¤šé‡å…±çº¿æ€§çš„é—®é¢˜ã€‚<strong>å²­å›å½’æ˜¯ä¸€ç§æœ‰åä¼°è®¡</strong>ã€‚</p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305091525.png"
        data-srcset="https://img.zhengyua.cn/img/20200305091525.png, https://img.zhengyua.cn/img/20200305091525.png 1.5x, https://img.zhengyua.cn/img/20200305091525.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305091525.png"
        title="https://img.zhengyua.cn/img/20200305091525.png" /></p>
<p><strong>é€‰æ‹©ğœ†å€¼ï¼Œä½¿åˆ°ï¼š</strong></p>
<ol>
<li>å„å›å½’ç³»æ•°çš„å²­ä¼°è®¡åŸºæœ¬ç¨³å®šã€‚</li>
<li>æ®‹å·®å¹³æ–¹å’Œå¢å¤§ä¸å¤ªå¤š</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305092001.png"
        data-srcset="https://img.zhengyua.cn/img/20200305092001.png, https://img.zhengyua.cn/img/20200305092001.png 1.5x, https://img.zhengyua.cn/img/20200305092001.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305092001.png"
        title="https://img.zhengyua.cn/img/20200305092001.png" /></p>
<ul>
<li>ğœ†å€¼ä¸ºæ¨ªåæ ‡,æ‰€æ±‚å‚æ•°ä¸ºçºµåæ ‡</li>
</ul>
<h4 id="sklearn-ä»£ç å®ç°">sklearn-ä»£ç å®ç°</h4>
<blockquote>
<p>Longleyæ•°æ®é›†</p>
<p>Longleyæ•°æ®é›†æ¥è‡ªJï¼Wï¼Longleyï¼ˆ1967ï¼‰å‘è¡¨åœ¨JASAä¸Šçš„ä¸€ç¯‡è®ºæ–‡ï¼Œæ˜¯å¼ºå…±çº¿æ€§çš„å®è§‚ç»æµæ•°æ®,åŒ…å«GNP deflator(GNPå¹³å‡æŒ‡æ•°)ã€GNP(å›½æ°‘ç”Ÿäº§æ€»å€¼)ã€Unemployed(å¤±ä¸šç‡)ã€ArmedForces(æ­¦è£…åŠ›é‡)ã€Population(äººå£)ã€year(å¹´ä»½)ï¼ŒEmlpoyed(å°±ä¸šç‡)ã€‚</p>
<ul>
<li>LongLeyæ•°æ®é›†å› å­˜åœ¨ä¸¥é‡çš„å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œåœ¨æ—©æœŸç»å¸¸ç”¨æ¥æ£€éªŒå„ç§ç®—æ³•æˆ–è®¡ç®—æœºçš„è®¡ç®—ç²¾åº¦</li>
</ul>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;longley.csv&#34;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span>     <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">83.</span>     <span class="mf">234.289</span>  <span class="mf">235.6</span>    <span class="mf">159.</span>     <span class="mf">107.608</span> <span class="mf">1947.</span>      <span class="mf">60.323</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">88.5</span>    <span class="mf">259.426</span>  <span class="mf">232.5</span>    <span class="mf">145.6</span>    <span class="mf">108.632</span> <span class="mf">1948.</span>      <span class="mf">61.122</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">88.2</span>    <span class="mf">258.054</span>  <span class="mf">368.2</span>    <span class="mf">161.6</span>    <span class="mf">109.773</span> <span class="mf">1949.</span>      <span class="mf">60.171</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">89.5</span>    <span class="mf">284.599</span>  <span class="mf">335.1</span>    <span class="mf">165.</span>     <span class="mf">110.929</span> <span class="mf">1950.</span>      <span class="mf">61.187</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">96.2</span>    <span class="mf">328.975</span>  <span class="mf">209.9</span>    <span class="mf">309.9</span>    <span class="mf">112.075</span> <span class="mf">1951.</span>      <span class="mf">63.221</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">98.1</span>    <span class="mf">346.999</span>  <span class="mf">193.2</span>    <span class="mf">359.4</span>    <span class="mf">113.27</span>  <span class="mf">1952.</span>      <span class="mf">63.639</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">99.</span>     <span class="mf">365.385</span>  <span class="mf">187.</span>     <span class="mf">354.7</span>    <span class="mf">115.094</span> <span class="mf">1953.</span>      <span class="mf">64.989</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">100.</span>     <span class="mf">363.112</span>  <span class="mf">357.8</span>    <span class="mf">335.</span>     <span class="mf">116.219</span> <span class="mf">1954.</span>      <span class="mf">63.761</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">101.2</span>    <span class="mf">397.469</span>  <span class="mf">290.4</span>    <span class="mf">304.8</span>    <span class="mf">117.388</span> <span class="mf">1955.</span>      <span class="mf">66.019</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">104.6</span>    <span class="mf">419.18</span>   <span class="mf">282.2</span>    <span class="mf">285.7</span>    <span class="mf">118.734</span> <span class="mf">1956.</span>      <span class="mf">67.857</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">108.4</span>    <span class="mf">442.769</span>  <span class="mf">293.6</span>    <span class="mf">279.8</span>    <span class="mf">120.445</span> <span class="mf">1957.</span>      <span class="mf">68.169</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">110.8</span>    <span class="mf">444.546</span>  <span class="mf">468.1</span>    <span class="mf">263.7</span>    <span class="mf">121.95</span>  <span class="mf">1958.</span>      <span class="mf">66.513</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">112.6</span>    <span class="mf">482.704</span>  <span class="mf">381.3</span>    <span class="mf">255.2</span>    <span class="mf">123.366</span> <span class="mf">1959.</span>      <span class="mf">68.655</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">114.2</span>    <span class="mf">502.601</span>  <span class="mf">393.1</span>    <span class="mf">251.4</span>    <span class="mf">125.368</span> <span class="mf">1960.</span>      <span class="mf">69.564</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">115.7</span>    <span class="mf">518.173</span>  <span class="mf">480.6</span>    <span class="mf">257.2</span>    <span class="mf">127.852</span> <span class="mf">1961.</span>      <span class="mf">69.331</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">116.9</span>    <span class="mf">554.894</span>  <span class="mf">400.7</span>    <span class="mf">282.7</span>    <span class="mf">130.081</span> <span class="mf">1962.</span>      <span class="mf">70.551</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ‡åˆ†æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºæ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç”Ÿæˆ50ä¸ªå€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">alphas_to_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºæ¨¡å‹,ä¿å­˜è¯¯å·®å€¼,CV:äº¤å‰éªŒè¯</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span> <span class="o">=</span> <span class="n">alphas_to_test</span><span class="p">,</span> <span class="n">store_cv_values</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å²­ç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#losså€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">cv_values_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="mf">0.40875510204081633</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”»å›¾</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å²­ç³»æ•°è·ŸLosså€¼çš„å…³ç³»</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas_to_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">cv_values_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">#é€‰å–çš„å²­ç³»æ•°çš„ä½ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">cv_values_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç®€å•æµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_data</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="n">out</span><span class="p">:</span><span class="n">array</span><span class="p">([</span><span class="mf">88.11216213</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">out</span><span class="p">:</span><span class="mf">88.2</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="è¿è¡Œç»“æœ-4">è¿è¡Œç»“æœ</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200305094231.png"
        data-srcset="https://img.zhengyua.cn/img/20200305094231.png, https://img.zhengyua.cn/img/20200305094231.png 1.5x, https://img.zhengyua.cn/img/20200305094231.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200305094231.png"
        title="https://img.zhengyua.cn/img/20200305094231.png" /></p>
<h4 id="æ ‡å‡†æ–¹ç¨‹æ³•-ä»£ç å®ç°">æ ‡å‡†æ–¹ç¨‹æ³•-ä»£ç å®ç°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;longley.csv&#34;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ‡åˆ†æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">y_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span>     <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span>      <span class="n">nan</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">83.</span>     <span class="mf">234.289</span>  <span class="mf">235.6</span>    <span class="mf">159.</span>     <span class="mf">107.608</span> <span class="mf">1947.</span>      <span class="mf">60.323</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">88.5</span>    <span class="mf">259.426</span>  <span class="mf">232.5</span>    <span class="mf">145.6</span>    <span class="mf">108.632</span> <span class="mf">1948.</span>      <span class="mf">61.122</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">88.2</span>    <span class="mf">258.054</span>  <span class="mf">368.2</span>    <span class="mf">161.6</span>    <span class="mf">109.773</span> <span class="mf">1949.</span>      <span class="mf">60.171</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">89.5</span>    <span class="mf">284.599</span>  <span class="mf">335.1</span>    <span class="mf">165.</span>     <span class="mf">110.929</span> <span class="mf">1950.</span>      <span class="mf">61.187</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">96.2</span>    <span class="mf">328.975</span>  <span class="mf">209.9</span>    <span class="mf">309.9</span>    <span class="mf">112.075</span> <span class="mf">1951.</span>      <span class="mf">63.221</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">98.1</span>    <span class="mf">346.999</span>  <span class="mf">193.2</span>    <span class="mf">359.4</span>    <span class="mf">113.27</span>  <span class="mf">1952.</span>      <span class="mf">63.639</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>   <span class="mf">99.</span>     <span class="mf">365.385</span>  <span class="mf">187.</span>     <span class="mf">354.7</span>    <span class="mf">115.094</span> <span class="mf">1953.</span>      <span class="mf">64.989</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">100.</span>     <span class="mf">363.112</span>  <span class="mf">357.8</span>    <span class="mf">335.</span>     <span class="mf">116.219</span> <span class="mf">1954.</span>      <span class="mf">63.761</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">101.2</span>    <span class="mf">397.469</span>  <span class="mf">290.4</span>    <span class="mf">304.8</span>    <span class="mf">117.388</span> <span class="mf">1955.</span>      <span class="mf">66.019</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">104.6</span>    <span class="mf">419.18</span>   <span class="mf">282.2</span>    <span class="mf">285.7</span>    <span class="mf">118.734</span> <span class="mf">1956.</span>      <span class="mf">67.857</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">108.4</span>    <span class="mf">442.769</span>  <span class="mf">293.6</span>    <span class="mf">279.8</span>    <span class="mf">120.445</span> <span class="mf">1957.</span>      <span class="mf">68.169</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">110.8</span>    <span class="mf">444.546</span>  <span class="mf">468.1</span>    <span class="mf">263.7</span>    <span class="mf">121.95</span>  <span class="mf">1958.</span>      <span class="mf">66.513</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">112.6</span>    <span class="mf">482.704</span>  <span class="mf">381.3</span>    <span class="mf">255.2</span>    <span class="mf">123.366</span> <span class="mf">1959.</span>      <span class="mf">68.655</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">114.2</span>    <span class="mf">502.601</span>  <span class="mf">393.1</span>    <span class="mf">251.4</span>    <span class="mf">125.368</span> <span class="mf">1960.</span>      <span class="mf">69.564</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">115.7</span>    <span class="mf">518.173</span>  <span class="mf">480.6</span>    <span class="mf">257.2</span>    <span class="mf">127.852</span> <span class="mf">1961.</span>      <span class="mf">69.331</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span>     <span class="n">nan</span>  <span class="mf">116.9</span>    <span class="mf">554.894</span>  <span class="mf">400.7</span>    <span class="mf">282.7</span>    <span class="mf">130.081</span> <span class="mf">1962.</span>      <span class="mf">70.551</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç»™æ ·æœ¬é¡¹åŠ åç½®å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">X_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">x_data</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">X_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å²­å›å½’æ ‡å‡†æ–¹ç¨‹æ³•æ±‚è§£å›å½’å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="n">xArr</span><span class="p">,</span> <span class="n">yArr</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">xMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">xArr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">yMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">yArr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">xTx</span> <span class="o">=</span> <span class="n">xMat</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">xMat</span> <span class="c1">#çŸ©é˜µä¹˜æ³•</span>
</span></span><span class="line"><span class="cl">    <span class="n">rxTx</span> <span class="o">=</span> <span class="n">xTx</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">xMat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">lam</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">rxTx</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;This mattrix cannot do inverse&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="n">ws</span> <span class="o">=</span> <span class="n">rxTx</span><span class="o">.</span><span class="n">I</span> <span class="o">*</span> <span class="n">xMat</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">yMat</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ws</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ws</span> <span class="o">=</span> <span class="n">weights</span><span class="p">(</span><span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span> <span class="mf">7.38107882e-04</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">2.07703836e-01</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">2.10076376e-02</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">5.05385441e-03</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="o">-</span><span class="mf">1.59173066e+00</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">1.10442920e-01</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="o">-</span><span class="mf">2.42280461e-01</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è®¡ç®—é¢„æµ‹å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">X_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">ws</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span> <span class="mf">83.55075226</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">86.92588689</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">88.09720228</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">90.95677622</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">96.06951002</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">97.81955375</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">98.36444357</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span> <span class="mf">99.99814266</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">103.26832266</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">105.03165135</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">107.45224671</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">109.52190685</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">112.91863666</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">113.98357055</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">115.29845063</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="mf">117.64279933</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="lasso">LASSO</h3>
<blockquote>
<ul>
<li>Tibshirani(1996)æå‡ºäº†Lasso(The Least Absolute Shrinkage and
Selectionator operator)ç®—æ³•</li>
<li>é€šè¿‡æ„é€ <strong>ä¸€ä¸ªä¸€é˜¶æƒ©ç½šå‡½æ•°è·å¾—ä¸€ä¸ªç²¾ç‚¼çš„æ¨¡å‹</strong>ï¼›é€šè¿‡æœ€ç»ˆç¡®å®šä¸€äº›
æŒ‡æ ‡ï¼ˆå˜é‡ï¼‰çš„ç³»æ•°ä¸ºé›¶ï¼ˆå²­å›å½’ä¼°è®¡ç³»æ•°ç­‰äº0çš„æœºä¼šå¾®ä¹å…¶å¾®ï¼Œ
é€ æˆç­›é€‰å˜é‡å›°éš¾ï¼‰ï¼Œè§£é‡ŠåŠ›å¾ˆå¼ºã€‚</li>
<li>æ“…é•¿å¤„ç†å…·æœ‰å¤šé‡å…±çº¿æ€§çš„æ•°æ®ï¼Œä¸å²­å›å½’ä¸€æ ·æ˜¯<strong>æœ‰åä¼°è®¡</strong> ã€‚</li>
</ul>
</blockquote>
<h4 id="lassoä¸å²­å›å½’">LASSOä¸å²­å›å½’</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200306111653.png"
        data-srcset="https://img.zhengyua.cn/img/20200306111653.png, https://img.zhengyua.cn/img/20200306111653.png 1.5x, https://img.zhengyua.cn/img/20200306111653.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200306111653.png"
        title="https://img.zhengyua.cn/img/20200306111653.png" /></p>
<ul>
<li>
<p>å›¾åƒæ¯”è¾ƒ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200306111842.png"
        data-srcset="https://img.zhengyua.cn/img/20200306111842.png, https://img.zhengyua.cn/img/20200306111842.png 1.5x, https://img.zhengyua.cn/img/20200306111842.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200306111842.png"
        title="https://img.zhengyua.cn/img/20200306111842.png" /></p>
</li>
<li>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200306112924.png"
        data-srcset="https://img.zhengyua.cn/img/20200306112924.png, https://img.zhengyua.cn/img/20200306112924.png 1.5x, https://img.zhengyua.cn/img/20200306112924.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200306112924.png"
        title="https://img.zhengyua.cn/img/20200306112924.png" /></p>
</li>
</ul>
<h4 id="sklearn-ä»£ç å®ç°lasso">sklearn-ä»£ç å®ç°Lasso</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;longley.csv&#34;</span><span class="p">,</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ‡åˆ†æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">y_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">16</span><span class="p">,)</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºæ¨¡å‹,å¾—åˆ°ä¸€ä¸ªåˆé€‚çš„è¯¯å·®å€¼,ç”±äºäº¤å‰éªŒè¯å…¶å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç”Ÿæˆéšæœºæ•°è¿›è¡Œæµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LassoCV</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#lassoç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç›¸å…³ç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å…¶ä¸­ä¸‰ä¸ªç‰¹å¾æœ‰å…±çº¿æ€§å³ä¸º0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="mf">20.03464209711722</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mf">0.10206856</span> <span class="mf">0.00409161</span> <span class="mf">0.00354815</span> <span class="mf">0.</span>         <span class="mf">0.</span>         <span class="mf">0.</span>        <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#é¢„æµ‹å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="c1">#çœŸå®å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mf">115.6461414</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="mf">115.7</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å¼¹æ€§ç½‘elastic-net">å¼¹æ€§ç½‘(Elastic Net)</h3>
<blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200306114817.png"
        data-srcset="https://img.zhengyua.cn/img/20200306114817.png, https://img.zhengyua.cn/img/20200306114817.png 1.5x, https://img.zhengyua.cn/img/20200306114817.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200306114817.png"
        title="https://img.zhengyua.cn/img/20200306114817.png" /></p>
<p>å¾ˆå®¹æ˜“çœ‹å‡º,q=2æ—¶å°±æ˜¯ä¸ºå²­å›å½’,q=1ä¸ºLassoå›å½’</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.zhengyua.cn/img/20200306114933.png"
        data-srcset="https://img.zhengyua.cn/img/20200306114933.png, https://img.zhengyua.cn/img/20200306114933.png 1.5x, https://img.zhengyua.cn/img/20200306114933.png 2x"
        data-sizes="auto"
        alt="https://img.zhengyua.cn/img/20200306114933.png"
        title="https://img.zhengyua.cn/img/20200306114933.png" /></p>
<h4 id="sklearn-ä»£ç å®ç°elasticnet">sklearn-ä»£ç å®ç°ElasticNet</h4>
<p>ç”±äºéƒ¨åˆ†ç»“æœä¸ä¸Šé¢ç±»ä¼¼,è¿™é‡Œå°±ä¸è´´å‡ºæ¥äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PYTHON" data-lang="PYTHON"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è½½å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;longley.csv&#34;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ‡åˆ†æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">x_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">y_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åˆ›å»ºæ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">ElasticNetCV</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#lå¼¹æ€§ç½‘ç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç›¸å…³ç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="mf">42.96498005089394</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mf">0.1016487</span>  <span class="mf">0.00416716</span> <span class="mf">0.00349843</span> <span class="mf">0.</span>         <span class="mf">0.</span>         <span class="mf">0.</span>        <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#é¢„æµ‹å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="c1">#çœŸå®å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mf">115.6037171</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="mf">115.7</span>
</span></span><span class="line"><span class="cl"><span class="err">â€‹```</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2020-03-06</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/ai/machine_learning/5.html/index.md" target="_blank">é˜…è¯»åŸå§‹æ–‡æ¡£</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’" data-hashtags="ai,machine_learning,note"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-hashtag="ai"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° WhatsApp" data-sharer="whatsapp" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Myspace" data-sharer="myspace" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Blogger" data-sharer="blogger" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Evernote" data-sharer="evernote" data-url="https://zhengyua.cn/posts/ai/machine_learning/5.html/" data-title="çº¿æ€§å›å½’ä¸éçº¿æ€§å›å½’"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/ai/">ai</a>,&nbsp;<a href="/tags/machine_learning/">machine_learning</a>,&nbsp;<a href="/tags/note/">note</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/ai/machine_learning/4.html/" class="prev" rel="prev" title="MachineLearning(AndrewNg)Notes-Week9"><i class="fas fa-angle-left fa-fw"></i>MachineLearning(AndrewNg)Notes-Week9</a>
            <a href="/posts/0.html/" class="next" rel="next" title="0">0<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container">
            <div class="footer-line">
                <span id="run-time"></span>
            </div>
            <span id="busuanzi_container_site_pv">
                æœ¬ç«™è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>æ¬¡
            </span><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/catwithtudou" target="_blank">ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp">æ¸ICPå¤‡19012006å·-1</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒ."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"id-1":"ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸'s blog","id-2":"ä¸€ç›´æ˜¯é˜µé›¨ğŸŒ¦ï¸'s blog"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"},{"display":false,"left":"$","right":"$"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"type":"lunr"},"twemoji":true,"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-J45YPF1TLY', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-J45YPF1TLY" async></script><script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?a129553334cecc8d46914f193ead738b";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "Ja18LNgLATVSfW2h",ck: "Ja18LNgLATVSfW2h"})</script></body>
</html>
